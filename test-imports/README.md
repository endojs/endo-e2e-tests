# Real package imports E2E tests

A suite of e2e tests to track Endo's compatibility with the npm ecosystem.

## Run

First run

```
npm start
```

It only needs to be installed once.

To execute tests, run:

```
npm test
```

### Testing local instance

To test your local Endo, open `index.mjs` and switch the imports to your local path.

Example

```js
import '../../endo/packages/ses/index.js';
import { importLocation } from '../../endo/packages/compartment-mapper/index.js';
```

## Cases

Dependencies in `test-imports/package.json` are tested by default.  
Each dependency has test cases generated for it checking if it works in cjs and in esm contexts.

You can manually add test cases to `test-imports/cases` and all files there will run.

### Adding cases

Default test cases are generated by running

```
npm run install-case 'packagename'
npm run generate-cases
```

Existing files will not be overwritten. To regenerate all cases from dependencies run `npm mrun generate-cases overwrite`

### Test case format

Each file in `test-imports/cases` is used when you run tests.  
A test case must export `expected` and `actual` - these two will be passed to Ava's `deepEqual` assertion.
